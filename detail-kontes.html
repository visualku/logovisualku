<!DOCTYPE html>
<html lang="id">
<head>
    <title>Detail Kontes - LogoVisualku</title>
</head>
<body>
    <input type="file" id="fileInput" accept="image/*">
    <button onclick="upload()">Upload (350x280px, <300KB)</button>
    <div id="gallery"></div>

    <!-- Firebase SDK (Global Version) -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBmoIXKp8BABwBMqKKXhSUBLGnYSnKNAYg",
            authDomain: "logovisualku.firebaseapp.com",
            projectId: "logovisualku",
            storageBucket: "logovisualku.firebasestorage.app",
            messagingSenderId: "64489762880",
            appId: "1:64489762880:web:f55f26b068044f1320afa5"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        async function upload() {
            const file = document.getElementById('fileInput').files[0];
            if (!file) return;

            if (file.size > 300 * 1024) {
                alert("File harus <300KB");
                return;
            }

            const img = new Image();
            img.src = URL.createObjectURL(file);
            img.onload = async () => {
                if (img.width !== 350 || img.height !== 280) {
                    alert("Ukuran harus 350x280px");
                    return;
                }

                await db.collection('submissions').add({
                    fileName: file.name,
                    driveLink: 'https://drive.google.com/file/d/ABC123/view',
                    uploadedAt: new Date(),
                    designerId: auth.currentUser.uid
                });
                alert("Upload berhasil ke Google Drive Anda!");
            };
        }

        db.collection('submissions').onSnapshot(snapshot => {
            const gallery = document.getElementById('gallery');
            gallery.innerHTML = '';
            snapshot.docChanges().forEach(change => {
                const data = change.doc.data();
                const img = document.createElement('img');
                img.src = 'https://placehold.co/150x150/001f4d/ffffff?text=LOGO';
                img.style.margin = '5px';
                gallery.appendChild(img);
            });
        });
    </script>
</body>
</html>
